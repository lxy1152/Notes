---
title: 1808.好因子的最大数目
katex: true
categories:
  - LeetCode
  - 题解
  - 1801-1900
tags:
  - 位运算
  - 数学
  - 周赛
abbrlink: 36835ba
date: 2021-03-29 16:36:18
description: 纯数学题，与343题思路一样
cover: https://images.unsplash.com/photo-1538131052268-1af52c1db73d?ixid=MXwxMjA3fDB8MHx0b3BpYy1mZWVkfDE0fGJvOGpRS1RhRTBZfHxlbnwwfHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60
---

## 题目信息

### 题目描述

给你一个正整数 `primeFactors` 。你需要构造一个正整数 `n`，它满足以下条件：

1. `n` 质因数（质因数需要考虑重复的情况）的数目不超过 `primeFactors` 个
2. `n` 好因子的数目最大化： 如果 `n` 的一个因子可以被 `n` 的每一个质因数整除，我们称这个因子是**好因子**。比方说，如果 `n = 12`，那么它的质因数为 `[2,2,3]`，那么 `6` 和 `12` 是好因子，但 `3` 和 `4` 不是。

请你返回 `n` 的好因子的最大数目。由于答案可能会很大，请返回答案对 $10^9 + 7$ 取余的结果。

{% note info flat %}
请注意，质数的定义是大于 `1`，且不能被分解为两个小于该数的自然数相乘的数。一个数 `n` 的质因子是将 `n` 分解为若干个质因子，且它们的乘积为 `n`。
{% endnote %}

{% note warning flat %}
$1 \le primeFactors \le 10^9$
{% endnote %}

### 示例输出

{% tabs sample %}
<!-- tab 示例输出1 -->
输入： `primeFactors = 5`
输出： `6`
<!-- endtab -->

<!-- tab 示例输出2 -->
输入： `primeFactors = 8`
输出： `18`
<!-- endtab -->
{% endtabs %}

## 解题思路

{% note info flat %}
纯数学题，本题和[343. 整数拆分](https://leetcode-cn.com/problems/integer-break/)的数学逻辑是相同的。
代码实现中幂运算的部分参考[50. Pow(x, n)](https://leetcode-cn.com/problems/powx-n/)。
{% endnote %}

假设对于某正整数 `n`，其质因子为：`b1`，`b2`，$\dots$，`bm`。每个质因子的个数为：`a1`，`a2`，$\dots$，`am`个。那么最终的好因子的个数等于：$a_1\times a_2\times \dots \times a_m$。根据题意这个值的最大值就是最终的答案，与这个正整数的值，其因子的值实际上是无关的。

由算术-几何平均不等式：$\dfrac {x_1 + x_2 + \dots +x_n} n \ge \sqrt[n]{x_1 \times x_2 \times \dots \times x_n}$（当且仅当每个值都相等时等号成立），可得：当且仅当$a_1=a_2=\dots=a_n$时，$a_1\times a_2\times \dots \times a_m$ 取得最大值。

假设将数字 `n` 以因子 `x` 等分为 `a` 份，那么 $n = ax$，其乘积为：$x^a={(x^{\frac 1 x})}^n$，得到 $x^{\frac 1 x}$ 需要取到最大值。

令：$y = x^{\frac 1 x}$，对 $y$ 两边同时取对数并求导得到：$y'= \dfrac {1 - \ln x} {x^2} x^{\frac 1 x}$。

令 $y = 0$，得到：$1 - \ln x = 0$，所以$x = e$。由于：

$$
y'
\begin{cases}
> 0, & x\in [-\infty, e)\\
< 0, & x\in (e, \infty]
\end{cases}
$$

所以 $x=e$ 是 $y = x^{\frac 1 x}$ 的极大值点。

但题目中需要取整数，与 $e$ 临近的整数是 `3` 和 `4`，$y(3) = 3^{\frac 1 3} \approx 1.44$，$y(4) = 4^{\frac 1 4} \approx 1.41$。因此在三等分时会使最后的结果达到最大值。

考虑有余数的情况：
1. 余数 `2`：保留余数就好了，最后的结果是 $3^a \times 2$
2. 余数 `1`：需要拆出一个 `3`，构成 $2 \times 2$，最后的结果是 $3^{a - 1} \times 4$

## 代码实现

```java
public int maxNiceDivisors(int primeFactors) {
    if (primeFactors <= 3) {
        return primeFactors;
    }

    long result = 0;
    int a = primeFactors / 3;
    int b = primeFactors % 3;

    // 整除的情况
    if (b == 0) {
        result = quickPow(3, a);
    }
    // 余数1的情况
    else if (b == 1) {
        result = quickPow(3, a - 1) * 4;
    }
    // 余数2的情况
    else {
        result = quickPow(3, a) * 2;
    }

    return (int) (result % 1000000007);
}

public long quickPow(int x, int n) {
    int mod = 1000000007;
    long result = 1;
    long base = x;
    while (n != 0) {
        if ((n & 1) != 0) {
            result = result * base % mod;
        }
        base = base * base % mod;
        n >>= 1;
    }
    return result;
}
```

{% note success flat %}
执行用时：0 ms, 在所有 Java 提交中击败了100.00%的用户
内存消耗：35.3 MB, 在所有 Java 提交中击败了100.00%的用户
{% endnote %}

---
